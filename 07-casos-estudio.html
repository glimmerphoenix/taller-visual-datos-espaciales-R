<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Casos de estudio – Visualización de datos espaciales con R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-add-resources.html" rel="next">
<link href="./06-dashboards.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-04e1f1103201cc0a83f720091ef4aae4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.3/leaflet.js"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-casos-estudio.html">Aplicaciones</a></li><li class="breadcrumb-item"><a href="./07-casos-estudio.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Casos de estudio</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualización de datos espaciales con R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-datos-espaciales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Datos espaciales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-visualizacion-basica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Visualización básica</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Visualización avanzada</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-visualizacion-avanzada.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visualización avanzada</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-mapas-interactivos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mapas interactivos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-dashboards.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dashboards</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Aplicaciones</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-casos-estudio.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Casos de estudio</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-add-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Recursos adicionales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Apéndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-command-ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Referencia de comandos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Paquetes R y atribuciones</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-refs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#representación-de-datos-espaciales-con-ggplot2" id="toc-representación-de-datos-espaciales-con-ggplot2" class="nav-link active" data-scroll-target="#representación-de-datos-espaciales-con-ggplot2"><span class="header-section-number">7.1</span> Representación de datos espaciales con <code>ggplot2</code></a></li>
  <li><a href="#uso-del-paquete-mapspain" id="toc-uso-del-paquete-mapspain" class="nav-link" data-scroll-target="#uso-del-paquete-mapspain"><span class="header-section-number">7.2</span> Uso del paquete <code>mapSpain</code></a>
  <ul class="collapse">
  <li><a href="#primer-ejemplo-municipios-de-castilla-la-mancha" id="toc-primer-ejemplo-municipios-de-castilla-la-mancha" class="nav-link" data-scroll-target="#primer-ejemplo-municipios-de-castilla-la-mancha"><span class="header-section-number">7.2.1</span> Primer ejemplo: municipios de Castilla-La Mancha</a></li>
  <li><a href="#diccionarios-de-términos" id="toc-diccionarios-de-términos" class="nav-link" data-scroll-target="#diccionarios-de-términos"><span class="header-section-number">7.2.2</span> Diccionarios de términos</a></li>
  <li><a href="#delimitaciones-en-mapa-político" id="toc-delimitaciones-en-mapa-político" class="nav-link" data-scroll-target="#delimitaciones-en-mapa-político"><span class="header-section-number">7.2.3</span> Delimitaciones en mapa político</a></li>
  <li><a href="#códigos-nuts" id="toc-códigos-nuts" class="nav-link" data-scroll-target="#códigos-nuts"><span class="header-section-number">7.2.4</span> Códigos NUTS</a></li>
  <li><a href="#límites-políticos-comunidades-autónomas" id="toc-límites-políticos-comunidades-autónomas" class="nav-link" data-scroll-target="#límites-políticos-comunidades-autónomas"><span class="header-section-number">7.2.5</span> Límites políticos: Comunidades Autónomas</a></li>
  <li><a href="#límities-políticos-municipios" id="toc-límities-políticos-municipios" class="nav-link" data-scroll-target="#límities-políticos-municipios"><span class="header-section-number">7.2.6</span> Límities políticos: municipios</a></li>
  <li><a href="#mapas-dinámicos-con-leaflet" id="toc-mapas-dinámicos-con-leaflet" class="nav-link" data-scroll-target="#mapas-dinámicos-con-leaflet"><span class="header-section-number">7.2.7</span> Mapas dinámicos con Leaflet</a></li>
  <li><a href="#mapas-geográficos" id="toc-mapas-geográficos" class="nav-link" data-scroll-target="#mapas-geográficos"><span class="header-section-number">7.2.8</span> Mapas geográficos</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-casos-estudio.html">Aplicaciones</a></li><li class="breadcrumb-item"><a href="./07-casos-estudio.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Casos de estudio</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Casos de estudio</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="representación-de-datos-espaciales-con-ggplot2" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="representación-de-datos-espaciales-con-ggplot2"><span class="header-section-number">7.1</span> Representación de datos espaciales con <code>ggplot2</code></h2>
</section>
<section id="uso-del-paquete-mapspain" class="level2 page-columns page-full" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="uso-del-paquete-mapspain"><span class="header-section-number">7.2</span> Uso del paquete <code>mapSpain</code></h2>
<p>Vamos a adaptar algunos ejemplos de la <a href="https://dieghernan.github.io/rpubs/mapSpain_RMadrid/#5">charla sobre el paquete <code>mapSpain</code></a> efectuada para el Grupo de Usuarios de R de Madrid, en noviembre de 2021.</p>
<p>Como hemos visto, este paquete facilita mucho la creación de mapas de España a diferentes niveles administrativos, permitiendo además usar imágenes de servicios <em>Web Map Service</em> (WMS) o <em>Web Map Tile Service</em> (WMTS). Los segundos suelen ser más eficientes, ya que generan previamente las imágenes de <em>teselas</em> (<em>tiles</em>) para niveles de escala predefinidos, almacenándolos en caché.</p>
<p>Otro aspecto muy útil son las funciones que incluye este paquete para normalización de los nombres de comunidades autónomas y provicinas, lo que facilita el proceso de manipulación y transformación de datos (aunque no sean, necesariamente, para usarse en visualizaciones espaciales).</p>
<p>Utiliza varias fuentes de información, tales como <a href="https://ec.europa.eu/eurostat/web/gisco">GISCO</a> (Eurostat, mediante el paquete <a href="https://ropengov.github.io/giscoR/"><code>giscoR</code></a>, el <a href="https://www.ign.es/">IGN</a>, así como diferentes instancias dentro de la Infraestructura de Datos Espaciales de España (<a href="https://www.idee.es/web/idee/segun-tipo-de-servicio">IDEE</a>) que publican servicios de teselas en los formatos WMS/WMTS admitidos por este paquete.</p>
<ul>
<li>Página web de documentación: <a href="https://ropenspain.github.io/mapSpain/" class="uri">https://ropenspain.github.io/mapSpain/</a>.</li>
</ul>
<p>Lo más habitual es descargar e instalar la versión estable del paquete, disponible en CRAN.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"mapSpain"</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapSpain)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.1     ✔ stringr   1.5.2
✔ ggplot2   4.0.0     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>Para acelerar la ejecución de código, dado que el paquete se descarga datos desde repositorios externos, es muy recomendable <strong>establecer un directorio de descarga</strong> específico para el usuario.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El argumento install = TRUE hace esta configuración persistente</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_set_cache_dir</span>(<span class="st">"~/R/mapslib/mapSpain"</span>, <span class="at">install =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="primer-ejemplo-municipios-de-castilla-la-mancha" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="primer-ejemplo-municipios-de-castilla-la-mancha"><span class="header-section-number">7.2.1</span> Primer ejemplo: municipios de Castilla-La Mancha</h3>
<p>En este primer ejemplo, exploramos cómo utilizar las funciones incluidas en <code>mapSpain</code> para representar los municipios de Castilla-La Mancha en diferentes colores, como muestra la <a href="#fig-example-muni-cl" class="quarto-xref">Figura&nbsp;<span>7.1</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapSpain)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>galicia <span class="ot">&lt;-</span> <span class="fu">esp_get_munic_siane</span>(<span class="at">region =</span> <span class="st">"Castilla-La Mancha"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalizar etiquetas</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Provincia =</span> <span class="fu">esp_dict_translate</span>(ine.prov.name, <span class="st">"es"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(galicia) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Provincia),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey70"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Provincias de Castilla-La Macha"</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="st">"Purples"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-example-muni-cl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example-muni-cl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-example-muni-cl-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example-muni-cl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.1: Representación de los municipios de las cinco provincias de Castilla-La Mancha.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="diccionarios-de-términos" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="diccionarios-de-términos"><span class="header-section-number">7.2.2</span> Diccionarios de términos</h3>
<p>Cuando representamos mapas, es conveniente contar con una representación unívoca de las etiquetas identificadoras de CCAA y provincias. La función <code>esp_dict_region_code()</code> realiza la conversión entre textos y códigos, soportando varios esquemas de codificación (ISO2, NUTS y dos estándares del INE).</p>
<p>Por otra parte, la función <code>esp_dict_transalate()</code> permite traducir las etiquetas a cinco idiomas distintos (castellano, inglés, catalán, gallego y vasco). Veamos algunos ejemplos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>provs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Murcia"</span>, <span class="st">"Sevilla"</span>, <span class="st">"Madrid"</span>, <span class="st">"Albacete"</span>, <span class="st">"Baleares"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Codificación de etiquetas</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_dict_region_code</span>(provs, <span class="at">destination =</span> <span class="st">"nuts"</span>)  <span class="co"># Indicar esquema codif.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ES62"  "ES618" "ES30"  "ES421" "ES53" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_dict_region_code</span>(provs, <span class="at">destination =</span> <span class="st">"cpro"</span>) <span class="co"># Estándar INE</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "30" "41" "28" "02" "07"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_dict_region_code</span>(provs, <span class="at">destination =</span> <span class="st">"iso2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ES-MC" "ES-SE" "ES-MD" "ES-AB" "ES-IB"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Traducciones</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_dict_translate</span>(provs, <span class="at">lang =</span> <span class="st">"en"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Murcia"           "Seville"          "Madrid"           "Albacete"        
[5] "Balearic Islands"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_dict_translate</span>(provs, <span class="at">lang =</span> <span class="st">"es"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Murcia"   "Sevilla"  "Madrid"   "Albacete" "Baleares"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">esp_dict_translate</span>(provs, <span class="at">lang =</span> <span class="st">"ga"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Murcia"         "Sevilla"        "Madrid"         "Albacete"      
[5] "Illas Baleares"</code></pre>
</div>
</div>
</section>
<section id="delimitaciones-en-mapa-político" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="delimitaciones-en-mapa-político"><span class="header-section-number">7.2.3</span> Delimitaciones en mapa político</h3>
<p>Con el paquete <code>mapSpain</code> se pueden obtener directamente los límites políticos a diferentes niveles:</p>
<ul>
<li>Todo el territorio nacional.</li>
<li><a href="https://ec.europa.eu/eurostat/web/nuts">NUTS</a> (Eurostat): clasificación estadística de Eurostat.
<ul>
<li>0 (país).</li>
<li>1,2 (CCAA, regiones básicas, políticas regionales).</li>
<li>3 (regiones menores, diagnósticos específicos).</li>
</ul></li>
<li>CCAA.</li>
<li>Provincias.</li>
<li>Municipios.</li>
</ul>
<p>En el caso de CCAA, provincias o municipios existen dos versiones que usan diferentes fuentes de datos. En todos los casos, se puede descargar la información en diferente proyecciones y con varios niveles de resolución.</p>
<ul>
<li><code>esp_get_xxxx()</code> (GISCO).</li>
<li><code>esp_get_xxxx_siane()</code> (fuente: IGN).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>esp <span class="ot">&lt;-</span> <span class="fu">esp_get_country</span>(<span class="at">moveCAN =</span> <span class="cn">FALSE</span>) <span class="co"># No desplaza Canarias</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(esp) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"#f9cd94"</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-map-spain-country" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-map-spain-country-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-map-spain-country-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-spain-country-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.2: Representación estándar del mapa de españa.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Se recomienda usar la opción <code>moveCAN = FALSE</code> siempre que se trabaje con imágenes, mapas interactivos o se vayan a realizar análisis espaciales.</p>
<p>También es habitual añadir líneas adicionales en el mapa. Por ejemplo, la <a href="#fig-map-span-can-provs" class="quarto-xref">Figura&nbsp;<span>7.3</span></a> muestra un mapa similar al anterior, pero además incluyendo el límite entre las dos provincias de Canarias.</p>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>esp_can <span class="ot">&lt;-</span> <span class="fu">esp_get_country</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>can_prov <span class="ot">&lt;-</span> <span class="fu">esp_get_can_provinces</span>()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>can_box <span class="ot">&lt;-</span> <span class="fu">esp_get_can_box</span>()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(esp_can) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> can_prov) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> can_box) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-map-span-can-provs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-map-span-can-provs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-map-span-can-provs-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-span-can-provs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.3: Mapa político de España que muestra el límite entre las dos provincias de Canarias.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="códigos-nuts" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="códigos-nuts"><span class="header-section-number">7.2.4</span> Códigos NUTS</h3>
<p>La <a href="https://ec.europa.eu/eurostat/documents/345175/629341/NUTS2021-NUTS2024.xlsx/2b35915f-9c14-6841-8197-353408c4522d?t=1717505289640">clasificación NUTS 2024</a> proporciona el listado de los códigos identificativos de las regiones a distintos niveles. La <a href="#fig-NUTS-codes-balearic-islands" class="quarto-xref">Figura&nbsp;<span>7.4</span></a> muestra el contenido del archivo para las tres regiones de menor nivel de Baleares. A su vez, la <a href="#fig-map-balearic-islands" class="quarto-xref">Figura&nbsp;<span>7.5</span></a> muestra el mapa ya representado.</p>
<div id="fig-NUTS-codes-balearic-islands" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-NUTS-codes-balearic-islands-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/NUTS-Balearic-Islands.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-NUTS-codes-balearic-islands-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.4: Códigos de nivel NUTS 3 para las regiones de menor tamaño de Islas Baleares. Fuente: <a href="https://ec.europa.eu/eurostat/web/nuts" class="uri">https://ec.europa.eu/eurostat/web/nuts</a>.
</figcaption>
</figure>
</div>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nuts3_baleares <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ES531"</span>, <span class="st">"ES532"</span>, <span class="st">"ES533"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>nuts3_sf <span class="ot">&lt;-</span> <span class="fu">esp_get_nuts</span>(<span class="at">region =</span> nuts3_baleares)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nuts3_sf) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> NAME_LATN)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Baleares: NUTS3"</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-map-balearic-islands" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-map-balearic-islands-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-map-balearic-islands-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-balearic-islands-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.5: Mapa de regiones de nivel NUTS 3 de las Islas Baleares.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="límites-políticos-comunidades-autónomas" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="límites-políticos-comunidades-autónomas"><span class="header-section-number">7.2.5</span> Límites políticos: Comunidades Autónomas</h3>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ccaa <span class="ot">&lt;-</span> <span class="fu">esp_get_ccaa</span>(<span class="at">ccaa =</span> <span class="fu">c</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Catalunya"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Comunidad Valenciana"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Aragón"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Baleares"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>ccaa <span class="ot">&lt;-</span> ccaa <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ccaa_cat =</span> <span class="fu">esp_dict_translate</span>(ccaa<span class="sc">$</span>ine.ccaa.name, <span class="st">"ca"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ccaa) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ccaa_cat)) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Comunitats autònomes"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">type =</span> <span class="fu">hcl.colors</span>(<span class="dv">4</span>, <span class="st">"Plasma"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ccaa-east-spain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccaa-east-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-ccaa-east-spain-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccaa-east-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.6: Mapa de varias CCAA en la zona este de España.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Con el servicio <code>*_siane</code> (IGN), si se pasa entre los valores una entidad de orden superior (por ejemplo, una CCAA cuando el resto son provincias), entonces se obtienen todas las entidades del mismo nivel que el resto de la lista dentro de la entidad de orden superior. En el siguiente ejemplo, <code>Castilla-La Mancha</code> es una CCAA y el resto son provincias.</p>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>provs <span class="ot">&lt;-</span> <span class="fu">esp_get_prov_siane</span>(<span class="fu">c</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Castilla-La Mancha"</span>, <span class="st">"Jaén"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Murcia"</span>, <span class="st">"Alicante"</span>, <span class="st">"Valencia"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(provs) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> prov.shortname.es),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.9</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">type =</span> <span class="fu">hcl.colors</span>(<span class="dv">12</span>, <span class="st">"Cividis"</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Provincias"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ccaa-provs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccaa-provs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-ccaa-provs-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccaa-provs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.7: Varias provincias españoas, incluyendo todas las de Andalucía.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="límities-políticos-municipios" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="límities-políticos-municipios"><span class="header-section-number">7.2.6</span> Límities políticos: municipios</h3>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>munic <span class="ot">&lt;-</span> <span class="fu">esp_get_munic</span>(<span class="at">region =</span> <span class="st">"Albacete"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Datos de ejemplo: Población INE</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mapSpain<span class="sc">::</span>pobmun19, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cpro"</span>, <span class="st">"cmun"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(munic) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> pob19), <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">hcl.colors</span>(<span class="dv">100</span>, <span class="st">"Inferno"</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.breaks =</span> <span class="dv">10</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_comma</span>(),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="fu">guide_legend</span>()</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Habitantes"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Población en Albacete"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Datos INE (2019)"</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="st">"grey80"</span>),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>),</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-munic-quant" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-munic-quant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-munic-quant-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-munic-quant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.8: Representación de la población en municipios de la provincia de Albacete.
</figcaption>
</figure>
</div>
</div>
</div>
<p>En el <a href="https://socviz.co/maps.html#statebins">apartado 7.3</a> del libro sobre visualización de datos de K. Healy <span class="citation" data-cites="healy2019">(<a href="references.html#ref-healy2019" role="doc-biblioref">Healy, 2019</a>)</span> se pueden encontrar una representación esquemática más legible de las regiones de un país, llamada <em>statebins</em>, asociada a una variable cuantitativa. Esta representación esquemática es más apropiada cuando el foco de interés es comparar y mostrar resultados cuantitativos entre diferentes regiones sin que importe tanto realizar una representación gráfica fidedigna. La <a href="#fig-statebins-hex-spain" class="quarto-xref">Figura&nbsp;<span>7.9</span></a> y <a href="#fig-statebins-cuad-spain" class="quarto-xref">Figura&nbsp;<span>7.10</span></a> muestran dos ejemplos con este paquete para el mapa de España, usando hexágonos y cuadrados, respectivamente.</p>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>hex <span class="ot">&lt;-</span> <span class="fu">esp_get_hex_ccaa</span>()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hex) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> iso2.ccaa.code)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not
give correct results for longitude/latitude data</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-statebins-hex-spain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statebins-hex-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-statebins-hex-spain-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statebins-hex-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.9: Representación con <em>statebins</em> hexagonales del mapa de España.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cuad <span class="ot">&lt;-</span> <span class="fu">esp_get_grid_prov</span>()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cuad) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> iso2.prov.code)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not
give correct results for longitude/latitude data</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-statebins-cuad-spain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statebins-cuad-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-statebins-cuad-spain-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statebins-cuad-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.10: Representación con <em>statebins</em> cuadrados del mapa de España.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="mapas-dinámicos-con-leaflet" class="level3 page-columns page-full" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="mapas-dinámicos-con-leaflet"><span class="header-section-number">7.2.7</span> Mapas dinámicos con Leaflet</h3>
<p>Los proveedores de diferentes organismos públicos se han conseugido del plug-in para Leaflet <a href="https://dieghernan.github.io/leaflet-providersESP/visor/">leaflet-providerESP</a>.</p>
<div class="cell column-page-right" data-fig-with="12">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>stations <span class="ot">&lt;-</span> <span class="fu">esp_get_railway</span>(<span class="at">spatialtype =</span> <span class="st">"point"</span>, <span class="at">epsg =</span> <span class="dv">4326</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(stations, <span class="at">elementId  =</span> <span class="st">"railways"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderEspTiles</span>(<span class="st">"IGNBase.Gris"</span>, <span class="at">group =</span> <span class="st">"Base"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderEspTiles</span>(<span class="st">"MTN"</span>, <span class="at">group =</span> <span class="st">"MTN"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderEspTiles</span>(<span class="st">"RedTransporte.Ferroviario"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">group =</span> <span class="st">"Lineas Ferroviarias"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">group =</span> <span class="st">"Estaciones"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="fu">sprintf</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;strong&gt;%s&lt;/strong&gt;"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    stations<span class="sc">$</span>rotulo) <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lapply</span>(htmltools<span class="sc">::</span>HTML)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseGroups =</span> <span class="fu">c</span>(<span class="st">"Base"</span>, <span class="st">"MTN"</span>),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">overlayGroups =</span> <span class="fu">c</span>(<span class="st">"Lineas Ferroviarias"</span>, <span class="st">"Estaciones"</span>),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-leaflet-spain" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-leaflet-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="leaflet html-widget html-fill-item" id="railways" style="width:100%;height:742px;"></div>
<script type="application/json" data-for="railways">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://www.ign.es/wmts/ign-base?service=WMTS&request=GetTile&version=1.0.0&format=image/jpeg&layer=IGNBase-gris&style=default&tilematrixset=GoogleMapsCompatible&tilematrix={z}&tilerow={y}&tilecol={x}",null,"Base",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"minzoom":0,"maxzoom":18,"tilesize":256,"errortileurl":"","nowrap":false,"zoomoffset":0,"zoomreverse":false,"zindex":1,"detectretina":false,"attribution":"CC BY 4.0 scne.es. Sistema Geogr&aacute;fico Nacional <a href='http://www.ign.es'>IGN<\/a>"}]},{"method":"addTiles","args":["https://ign.es/wmts/mapa-raster?service=WMTS&request=GetTile&version=1.0.0&format=image/jpeg&layer=MTN&style=default&tilematrixset=GoogleMapsCompatible&tilematrix={z}&tilerow={y}&tilecol={x}",null,"MTN",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"minzoom":"4","maxzoom":18,"tilesize":256,"errortileurl":"","nowrap":false,"zoomoffset":0,"zoomreverse":false,"zindex":1,"detectretina":false,"attribution":"<a href='http://www.ign.es/'>Infraestructura de Datos Espaciales de Espa&ntilde;a (IDEE)<\/a>"}]},{"method":"addWMSTiles","args":["https://servicios.idee.es/wms-inspire/transportes",null,"Lineas Ferroviarias",{"styles":"","format":"image/png","transparent":"true","version":"1.1.1","errortileurl":"","nowrap":false,"detectretina":false,"attribution":"Sistema Geogr&aacute;fico Nacional <a href='http://www.scne.es'>SCNE<\/a>","layers":"TN.RailTransportNetwork.RailwayLink"}]},{"method":"addMarkers","args":[[42.36817572600006,42.23448249000006,43.35037517000006,43.48843134700007,42.82531675000007,39.57651037400007,39.56786683200005,39.72121992900003,43.27316647000004,39.78582684300005,39.76736332700006,42.86266387100005,43.25717867900005,42.24647742100007,42.25432425900004,43.31318431100004,42.68034543400006,43.21842259700003,43.01156292400003,42.44547199500005,42.84353684900003,42.33789137600007,43.56842937800008,43.35482738500008,43.45821198700003,43.37119058100006,43.41231488900007,43.35391716600003,42.80558805000004,42.59589044300003,42.54417835800007,41.57716055000003,42.51984932400006,38.96995215400005,38.97729610000005,38.99399706000003,38.97630830000003,38.83783086000005,41.98257333000004,39.17430265300004,38.89507095000005,42.13353545200005,41.51135236000005,41.45058428800007,41.35124593900008,41.30719354200005,41.55808071000007,40.66318161000004,40.24234223900004,41.23969776900003,41.15528282600008,39.67355510000004,39.62273780000004,39.42618050500005,39.45626431000005,39.53299174600005,39.48806797300006,41.75295465100004,41.36855696100002,41.92008984400007,39.38990311500004,39.36536736500005,41.92825928400003,37.65570444400004,37.60366961000005,37.41011708000008,37.38531972600003,37.18320652000006,36.54243276000005,36.51935076200004,36.12910440900004,38.34893498900004,42.43077735100007,42.60040876400006,42.45883396600004,42.19834602100008,42.00839011200003,42.46211665500005,40.96260367700006,41.64877679600005,41.56249684800008,41.67219195700005,40.54669027000006,38.42122800200008,38.32175445300004,41.11856863400004,41.61712916500005,41.64593129800005,41.72161229000005,39.00244120000008,40.47343982100006,39.96609934100007,37.17615976500008,36.83810564300006,40.93363066000006,36.69619001200005,36.71151746000004,40.64845660000003,40.64554783300008,40.06483957200004,40.34197120500005,40.32889578400005,40.24099330000007,40.02867552400005,40.03426256200004,39.99108816000006,39.86263770000005,38.86283551000002,37.26002992300005,38.69990346600008,38.69005026700006,38.91911803100004,38.99773394500005,38.27067560200004,37.97425150900006,37.89426735100005,37.77993947000004,43.54064227900005,40.44959583100007,40.51490780000006,40.62659748000004,40.74507856000002,40.82344354000003,41.30188365400005,42.04516736200003,42.05141204700004,42.07287703000003,42.27718108300007,42.34973481400004,42.83845139800007,43.15207485500008,43.26890774100008,43.29993840000003,43.12076786700004,43.30722823300005,43.36082459400006,43.48832956000007,43.34591528700003,42.83506507900006,43.31013378200004,43.20731154300006,43.00669695300007,42.90410345600003,43.31890485300005,42.16436449700007,41.79060316400006,41.74200207400003,41.72153506000006,41.51809958300004,41.97473798000004,42.75534957000008,42.39748096000005,42.43724676800008,41.75461452500008,42.29797810500003,41.82401269700006,41.82747158400008,41.46985760800004,41.58725590900008,41.57655145700005,41.18611928700005,41.18786690100006,41.10152113500004,40.93653723900007,40.04620572100004,39.59067310000006,39.58864100000005,39.07885900000008,39.54069703000005,38.77523201000002,38.62248621700007,37.64971570700004,37.20850018400006,37.43356664100003,37.04749277100007,37.09086586000006,37.60745902900004,37.19016555300004,39.94398352100006,40.03474517700005,39.93210513800005,39.91761696500004,39.95501205800008,40.58837775000006,38.92531906300007,39.17300101500007,38.04285599000008,38.65643649000003,37.99758562000005,37.93770868500008,37.82470884700007,38.68911677200003,41.14460930600006,41.32707324000006,37.99736447800007,43.41235238200005,43.45353986100008,40.60548726000007,40.24849129700004,41.19210547600005,40.40460060000004,41.19393537100007,43.56372941200004,41.39749415700004,41.42372687200003,38.99002756100003,37.96715582400003,37.33025905500006,41.96389121100003,40.05039198600008,39.46675550400005,39.44066346000005,36.68010393500003,43.30793983000007],[-3.677539631999934,-8.713094929999954,-1.786326409999958,-8.230400926999948,-1.661119463999967,2.653534635000028,3.208220100000062,2.91176820000004,-8.226929839999968,2.698658909000073,3.025155174000076,-8.549608478999971,-2.923975451999979,0.9616723510000611,2.95311791000006,-1.981390536999925,-2.952504272999931,-2.737960757999929,-7.546263860999943,-8.618571621999934,-2.674880903999963,-7.859546773999966,-5.916856228999961,-8.406934171999978,-3.819986140999958,-5.846106726999949,-2.728769002999968,-4.051945683999975,-5.626534099999958,-5.582349337999972,-6.597682583999926,1.631642240000076,-7.509818720999931,-5.801709909999943,-3.908854099999928,-0.5204109899999594,-0.1803889999999342,0.09981825200003414,2.820709344000022,-0.2589581569999382,-6.974148130999936,-0.4096950329999345,-5.751027215999954,2.249814394000055,-1.638889591999941,-4.914553443999978,2.105224143000044,-4.684980129999929,-3.702737701999979,-0.03750377199997956,1.118433291000031,-0.272726539999951,-0.5896671999999512,-7.236524661999965,-6.385495269999979,-0.5706674309999471,-0.3352737839999804,-2.46865416199995,2.172080459000028,-4.493122058999973,-3.205159615999946,-0.4140082079999274,2.247267085000033,-5.532775624999942,-0.9760407599999326,-1.582674205999979,-5.978156518999981,-3.606996049999964,-4.623338629999978,-6.284040356999981,-5.465220601999931,-0.4854442909999648,1.924582779000048,-8.749295519999976,-2.44937170399993,2.190060301000074,-4.539500804999932,-6.047903833999953,-5.653057657999966,-0.8868243649999386,2.011629853000045,-3.692694697999968,-3.635536059999936,-6.407220350999978,-6.773300254999981,1.258318365000036,0.6455299260000515,-4.717454519999933,1.827777956000034,-3.376602099999957,-3.681580974999974,-4.837678816999926,-5.788387967999938,-2.450015893999932,-4.113748889999954,-6.120107527999949,-4.431588289999979,-3.761991399999943,-3.182166403999929,-2.137656611999944,-1.115490275999946,-3.869283396999947,-3.769341499999939,-6.093413473999931,-3.619956158999969,-0.04494166799997856,-4.011090899999942,-1.099164935999966,-6.950360469999964,-0.4753782279999541,-4.115422204999959,-6.34174988999996,-1.854579698999942,-0.6983523429999536,-1.128088050999963,-4.775897708999935,-3.790932249999969,-5.667011489999936,-3.502988221999942,-3.877975599999957,-4.01106507999998,-4.056093420999957,-3.962123199999951,-4.712542509999935,-6.637803047999967,-8.649718262999954,-8.622605929999963,-8.602903721999951,-8.587387421999949,-5.527700080999978,-5.839171284999964,-5.624235311999939,-5.688971369999933,-5.570257255999934,-5.837368469999944,-5.967374890999963,-6.107526459999974,-4.012372400999936,-4.191383372999951,-3.037923425999963,-3.100270660999968,-3.016285152999956,-2.19168704599997,-1.918959196999936,-1.669523516999959,-1.173231957999974,-1.169744566999952,-1.017711979999945,-0.6325125809999577,-0.5367567499999382,-0.5069529529999386,2.154860160000055,3.144700589000024,2.662821399000052,2.15427016700005,1.884727849000058,1.764008577000027,1.950038580000069,2.547175305000053,2.287122676000024,1.465634240000043,1.524619509000047,0.6770401990000323,0.8402191820000553,0.05066872800006195,-0.457365599999946,-0.3307040999999344,-0.5119187999999326,-1.178856459999963,-0.9581374999999639,-0.8948389989999441,-0.7992688529999441,-2.918660391999936,-3.309021694999956,-4.722790863999933,-4.722396275999927,-5.731636859999981,-6.867648752999969,-6.08740858699997,-3.899012004999975,-3.874975440999947,-3.857682379999972,-3.732252762999963,-3.123449216999973,-1.625437786999953,-3.23175370499996,-3.605904539999926,-3.443999470999927,-3.813479129999962,-4.77053961699994,-4.965571294999961,-5.306091992999939,-2.498909954999931,-1.791279409999959,-1.008172740999953,-5.704921218999971,-5.817440783999928,-6.825882489999969,-3.835756956999944,1.272171869000033,-3.689188399999978,-0.3229226759999619,-5.714411527999971,2.182636950000074,2.217486062000035,-0.1560104849999675,-1.206824099999949,-4.811448670999937,-4.428262148999977,-2.171596488999967,-0.3913177159999464,-0.364428969999949,-4.49149261499997,-2.993109539999978],null,null,"Estaciones",{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<strong>Burgos<\/strong>","<strong>Vigo<\/strong>","<strong>Irun<\/strong>","<strong>Ferrol<\/strong>","<strong>Pamplona/Iruña<\/strong>","<strong>Palma<\/strong>","<strong>Manacor<\/strong>","<strong>Inca<\/strong>","<strong>Betanzos<\/strong>","<strong>Sóller<\/strong>","<strong>Sa Pobla<\/strong>","<strong>Santiago de Compostela<\/strong>","<strong>Bilbao<\/strong>","<strong>La Pobla de Segur<\/strong>","<strong>Figueres<\/strong>","<strong>Donostia/San Sebastián<\/strong>","<strong>Miranda de Ebro<\/strong>","<strong>Amorebieta<\/strong>","<strong>Lugo<\/strong>","<strong>Pontevedra<\/strong>","<strong>Vitoria-Gasteiz<\/strong>","<strong>Ourense<\/strong>","<strong>Avilés<\/strong>","<strong>A Coruña<\/strong>","<strong>Santander<\/strong>","<strong>Oviedo<\/strong>","<strong>Bermeo<\/strong>","<strong>Torrelavega<\/strong>","<strong>La Robla<\/strong>","<strong>León<\/strong>","<strong>Ponferrada<\/strong>","<strong>Igualada<\/strong>","<strong>Monforte de Lemos<\/strong>","<strong>Villanueva de la Serena<\/strong>","<strong>Ciudad Real<\/strong>","<strong>Xàtiva<\/strong>","<strong>Gandia<\/strong>","<strong>Dénia<\/strong>","<strong>Girona<\/strong>","<strong>Cullera<\/strong>","<strong>Badajoz<\/strong>","<strong>Huesca<\/strong>","<strong>Zamora<\/strong>","<strong>Badalona<\/strong>","<strong>Calatayud<\/strong>","<strong>Medina del Campo<\/strong>","<strong>Sabadell<\/strong>","<strong>Ávila<\/strong>","<strong>Pinto<\/strong>","<strong>Caspe<\/strong>","<strong>Reus<\/strong>","<strong>Sagunto/Sagunt<\/strong>","<strong>Llíria<\/strong>","<strong>Valencia de Alcántara<\/strong>","<strong>Cáceres<\/strong>","<strong>Riba-roja de Túria<\/strong>","<strong>Valencia<\/strong>","<strong>Soria<\/strong>","<strong>Barcelona<\/strong>","<strong>Venta de Baños<\/strong>","<strong>Alcázar de San Juan<\/strong>","<strong>Silla<\/strong>","<strong>Vic<\/strong>","<strong>Lora del Río<\/strong>","<strong>Cartagena<\/strong>","<strong>Águilas<\/strong>","<strong>Sevilla<\/strong>","<strong>Granada<\/strong>","<strong>Fuengirola<\/strong>","<strong>Cádiz<\/strong>","<strong>Algeciras<\/strong>","<strong>Alicante/Alacant<\/strong>","<strong>Puigcerdà<\/strong>","<strong>Vilagarcía de Arousa<\/strong>","<strong>Logroño<\/strong>","<strong>Ripoll<\/strong>","<strong>Palencia<\/strong>","<strong>Astorga<\/strong>","<strong>Salamanca<\/strong>","<strong>Zaragoza<\/strong>","<strong>Terrassa<\/strong>","<strong>Aranda de Duero<\/strong>","<strong>Alcobendas-S.S. de los Reyes<\/strong>","<strong>Zafra<\/strong>","<strong>Jerez de los Caballeros<\/strong>","<strong>Tarragona<\/strong>","<strong>Lleida<\/strong>","<strong>Valladolid<\/strong>","<strong>Manresa<\/strong>","<strong>Manzanares<\/strong>","<strong>Madrid-Chamartín<\/strong>","<strong>Talavera de la Reina<\/strong>","<strong>Utrera<\/strong>","<strong>Almería<\/strong>","<strong>Segovia<\/strong>","<strong>Jerez de la Frontera<\/strong>","<strong>Málaga<\/strong>","<strong>Colmenar Viejo<\/strong>","<strong>Guadalajara<\/strong>","<strong>Cuenca<\/strong>","<strong>Teruel<\/strong>","<strong>Móstoles-El Soto<\/strong>","<strong>Parla<\/strong>","<strong>Plasencia<\/strong>","<strong>Aranjuez<\/strong>","<strong>Castellón de la Plana/Castelló de la Plana<\/strong>","<strong>Toledo<\/strong>","<strong>Almansa<\/strong>","<strong>Huelva<\/strong>","<strong>Alcoy/Alcoi<\/strong>","<strong>Puertollano<\/strong>","<strong>Mérida<\/strong>","<strong>Albacete<\/strong>","<strong>Elche/Elx<\/strong>","<strong>Murcia-del Carmen<\/strong>","<strong>Córdoba<\/strong>","<strong>Jaén<\/strong>","<strong>Gijón/Xixón<\/strong>","<strong>San Fernando de Henares<\/strong>","<strong>Pinar de las Rozas<\/strong>","<strong>Villalba<\/strong>","<strong>Cercedilla<\/strong>","<strong>Los Cotos<\/strong>","<strong>Olmedo-Alta Velocidad<\/strong>","<strong>Puebla de Sanabria<\/strong>","<strong>Tui<\/strong>","<strong>Guillarei<\/strong>","<strong>Redondela<\/strong>","<strong>Arcade<\/strong>","<strong>Matallana<\/strong>","<strong>La Pola de Lena<\/strong>","<strong>Laviana<\/strong>","<strong>El Entrego<\/strong>","<strong>Collanzo<\/strong>","<strong>Soto del Rey<\/strong>","<strong>Trubia<\/strong>","<strong>Pravia<\/strong>","<strong>Sierrapando<\/strong>","<strong>Mataporquera<\/strong>","<strong>Muskiz<\/strong>","<strong>Aranguren<\/strong>","<strong>Orduña<\/strong>","<strong>Altsasu/Alsasua<\/strong>","<strong>Pasaia<\/strong>","<strong>Castejón<\/strong>","<strong>Cabañas de Ebro<\/strong>","<strong>Grisén<\/strong>","<strong>Casetas<\/strong>","<strong>Fuentes de Ebro<\/strong>","<strong>Tardienta<\/strong>","<strong>Canfranc<\/strong>","<strong>Núria<\/strong>","<strong>Portbou<\/strong>","<strong>Massanes<\/strong>","<strong>Ribes de Freser<\/strong>","<strong>Sallent<\/strong>","<strong>Súria<\/strong>","<strong>Castellbisbal<\/strong>","<strong>Arenys de Mar<\/strong>","<strong>Granollers<\/strong>","<strong>Roda de Barà<\/strong>","<strong>Sant Vicenç de Calders<\/strong>","<strong>Móra la Nova<\/strong>","<strong>Vandellós<\/strong>","<strong>Benicasim/Benicàssim<\/strong>","<strong>Bétera<\/strong>","<strong>Rafelbunyol<\/strong>","<strong>Villanueva de Castellón<\/strong>","<strong>Utiel-Requena<\/strong>","<strong>La Encina<\/strong>","<strong>Villena- Alta Velocidad<\/strong>","<strong>Los Nietos<\/strong>","<strong>Huéneja-Dólar<\/strong>","<strong>Moreda<\/strong>","<strong>Bobadilla<\/strong>","<strong>Antequera-Santa Ana<\/strong>","<strong>Los Rosales<\/strong>","<strong>Huelva-Puerto<\/strong>","<strong>Monfragüe<\/strong>","<strong>Villaluenga-Yuncler<\/strong>","<strong>La Sagra<\/strong>","<strong>Algodor<\/strong>","<strong>Castillejo-Añover<\/strong>","<strong>Guadalajara-Yebes<\/strong>","<strong>Chinchilla de Monte-Aragón<\/strong>","<strong>Cinco Casas<\/strong>","<strong>Linares-Baeza<\/strong>","<strong>Santa Cruz de Mudela<\/strong>","<strong>Espelúy<\/strong>","<strong>Mirabueno<\/strong>","<strong>Almodóvar del Río<\/strong>","<strong>Almorchón<\/strong>","<strong>Torralba<\/strong>","<strong>Ateca<\/strong>","<strong>El Reguerón<\/strong>","<strong>El Berrón<\/strong>","<strong>Villabona de Asturias<\/strong>","<strong>Fuentes de Oñoro<\/strong>","<strong>Humanes<\/strong>","<strong>Camp de Tarragona<\/strong>","<strong>Madrid-Puerta de Atocha<\/strong>","<strong>Samper de Calanda<\/strong>","<strong>Puerto de Gijón/Xixón<\/strong>","<strong>Barcelona-Sants<\/strong>","<strong>Barcelona-França<\/strong>","<strong>Gandia-Port<\/strong>","<strong>Murcia-Mercancias<\/strong>","<strong>Puente Genil-Herrera<\/strong>","<strong>Magaz<\/strong>","<strong>Cuenca-Fernando Zóbel<\/strong>","<strong>Valencia-San Isidre<\/strong>","<strong>Valencia-Joaquín Sorolla<\/strong>","<strong>Los Prados<\/strong>","<strong>Santurtzi<\/strong>"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Base","MTN"],["Lineas Ferroviarias","Estaciones"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]}],"limits":{"lat":[36.12910440900004,43.56842937800008],"lng":[-8.749295519999976,3.208220100000062]}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-leaflet-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.11: Mapa dinámico de ubicaciones de estaciones de tren en España.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="mapas-geográficos" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="mapas-geográficos"><span class="header-section-number">7.2.8</span> Mapas geográficos</h3>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>hypsobath <span class="ot">&lt;-</span> <span class="fu">esp_get_hypsobath</span>()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Error on the data provided - There is an empty shape</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>hypsobath <span class="ot">&lt;-</span> hypsobath[<span class="sc">!</span>sf<span class="sc">::</span><span class="fu">st_is_empty</span>(hypsobath), ]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Tints from Wikipedia</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># https://en.wikipedia.org/wiki/Wikipedia:WikiProject_Maps/Conventions/</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Topographic_maps</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>bath_tints <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rev</span>(</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#D8F2FE"</span>, <span class="st">"#C6ECFF"</span>, <span class="st">"#B9E3FF"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#ACDBFB"</span>, <span class="st">"#A1D2F7"</span>, <span class="st">"#96C9F0"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#8DC1EA"</span>, <span class="st">"#84B9E3"</span>, <span class="st">"#79B2DE"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#71ABD8"</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>hyps_tints <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rev</span>(</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#F5F4F2"</span>, <span class="st">"#E0DED8"</span>, <span class="st">"#CAC3B8"</span>, <span class="st">"#BAAE9A"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#AC9A7C"</span>, <span class="st">"#AA8753"</span>, <span class="st">"#B9985A"</span>, <span class="st">"#C3A76B"</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#CAB982"</span>, <span class="st">"#D3CA9D"</span>, <span class="st">"#DED6A3"</span>, <span class="st">"#E8E1B6"</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#EFEBC0"</span>, <span class="st">"#E1E4B5"</span>, <span class="st">"#D1D7AB"</span>, <span class="st">"#BDCC96"</span>,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#A8C68F"</span>, <span class="st">"#94BF8B"</span>, <span class="st">"#ACD0A5"</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(hypsobath<span class="sc">$</span>val_inf))</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create palette</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>br_bath <span class="ot">&lt;-</span> <span class="fu">length</span>(levels[levels <span class="sc">&lt;</span> <span class="dv">0</span>])</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>br_terrain <span class="ot">&lt;-</span> <span class="fu">length</span>(levels) <span class="sc">-</span> br_bath</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">bath_tints</span>((br_bath)), <span class="fu">hyps_tints</span>((br_terrain)))</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hypsobath) <span class="sc">+</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(val_inf)),</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">9.5</span>, <span class="fl">4.4</span>),</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">35.8</span>, <span class="dv">44</span>)</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Elevation"</span>,</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">reverse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">keyheight =</span> .<span class="dv">8</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hypsobath-main-spain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hypsobath-main-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-hypsobath-main-spain-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hypsobath-main-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.12: Mapa orográfico (altitudes) de España, sin incluir Canarias.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-fig-with="10">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>hydroland <span class="ot">&lt;-</span> <span class="fu">esp_get_hydrobasin</span>(<span class="at">domain =</span> <span class="st">"land"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>hydrolandsea <span class="ot">&lt;-</span> <span class="fu">esp_get_hydrobasin</span>(<span class="at">domain =</span> <span class="st">"landsea"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hydroland) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> hydrolandsea, <span class="at">fill =</span> <span class="st">"skyblue4"</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> rotulo),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"serif"</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">9.5</span>, <span class="fl">4.5</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">44</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not
give correct results for longitude/latitude data</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-hydrobasin-spain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hydrobasin-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-casos-estudio_files/figure-html/fig-hydrobasin-spain-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hydrobasin-spain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.13: Mapa de las cuencas hidrográficas en territorio español.
</figcaption>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-healy2019" class="csl-entry" role="listitem">
Healy, K. (2019). <em>Data Visualization. A Practical Introduction</em>. Princeton University Press. <a href="https://socviz.co/">https://socviz.co/</a>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-dashboards.html" class="pagination-link" aria-label="Dashboards">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dashboards</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-add-resources.html" class="pagination-link" aria-label="Recursos adicionales">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Recursos adicionales</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>